<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="DrugUtilisation">
<title>Use addDrugUse and summariseDrugUse to explore a drug • DrugUtilisation</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Use addDrugUse and summariseDrugUse to explore a drug">
<meta property="og:description" content="DrugUtilisation">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">DrugUtilisation</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/addDrugUse.html">Use addDrugUse and summariseDrugUse to explore a drug</a>
    <a class="dropdown-item" href="../articles/addIndications-example.html">Add indications to Drug Utilisation Cohort</a>
    <a class="dropdown-item" href="../articles/introCreateCohort.html">Use DrugUtilisation to create cohort</a>
    <a class="dropdown-item" href="../articles/routePatternDose.html">Guide on using DrugUtilisataion package to compute drug use related information</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Use addDrugUse and summariseDrugUse to explore a drug</h1>
                        <h4 data-toc-skip class="author">Martí Català,
Mike Du, Yuchen Guo, Kim López-Güell, and Edward Burn</h4>
            
            <h4 data-toc-skip class="date">2024-02-10</h4>
      
      
      <div class="d-none name"><code>addDrugUse.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>In this vignette we introduce the use of <code><a href="../reference/addDrugUse.html">addDrugUse()</a></code>
and <code><a href="../reference/summariseDrugUse.html">summariseDrugUse()</a></code> functions to get drug-related
information of subjects in OMOP CDM tables and cohort tables.</p>
<div class="section level4">
<h4 id="create-mock-data-first">Create mock data first<a class="anchor" aria-label="anchor" href="#create-mock-data-first"></a>
</h4>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://darwin-eu-dev.github.io/DrugUtilisation/">DrugUtilisation</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://darwin-eu.github.io/CodelistGenerator/" class="external-link">CodelistGenerator</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://darwin-eu.github.io/CDMConnector/" class="external-link">CDMConnector</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://darwin-eu-dev.github.io/PatientProfiles/" class="external-link">PatientProfiles</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">cdm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mockDrugUtilisation.html">mockDrugUtilisation</a></span><span class="op">(</span>numberIndividual  <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="create-a-drug-utilisation-cohort">Create a drug utilisation cohort<a class="anchor" aria-label="anchor" href="#create-a-drug-utilisation-cohort"></a>
</h4>
<p>We will use Acetaminophen as our example drug to construct our drug
utilisation cohort. To begin, we will employ the package
CodelistGenerator to generate a concept list associated with
Acetaminophen.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">conceptList</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://darwin-eu.github.io/CodelistGenerator/reference/getDrugIngredientCodes.html" class="external-link">getDrugIngredientCodes</a></span><span class="op">(</span><span class="va">cdm</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"acetaminophen"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">conceptList</span></span>
<span><span class="co">#&gt; $acetaminophen</span></span>
<span><span class="co">#&gt; [1]  1125315  1125360  2905077 43135274</span></span></code></pre></div>
<p>Next, we create a drug utilisation cohort by using the conceptList
with the <code><a href="../reference/generateDrugUtilisationCohortSet.html">generateDrugUtilisationCohortSet()</a></code> function. For a
better understanding of the arguments and functionalities of
<code><a href="../reference/generateDrugUtilisationCohortSet.html">generateDrugUtilisationCohortSet()</a></code>, please refer to the
<em>Use DrugUtilisation to create a cohort</em> vignette.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cdm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generateDrugUtilisationCohortSet.html">generateDrugUtilisationCohortSet</a></span><span class="op">(</span></span>
<span>  cdm  <span class="op">=</span> <span class="va">cdm</span>,</span>
<span>  name <span class="op">=</span> <span class="st">"acetaminophen_users"</span>,</span>
<span>  conceptSet <span class="op">=</span> <span class="va">conceptList</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="adddruguse">addDrugUse<a class="anchor" aria-label="anchor" href="#adddruguse"></a>
</h2>
<p><code><a href="../reference/addDrugUse.html">addDrugUse()</a></code> function is used to add columns related to
the drug use. You must provide a cohort and a reference ingredient. See
an example below.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/addDrugUse.html">addDrugUse</a></span><span class="op">(</span></span>
<span>  cohort <span class="op">=</span> <span class="va">cdm</span><span class="op">[[</span><span class="st">"acetaminophen_users"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>  cdm    <span class="op">=</span> <span class="va">cdm</span>,</span>
<span>  ingredientConceptId <span class="op">=</span> <span class="fl">1125315</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: ??</span></span>
<span><span class="co">#&gt; Columns: 13</span></span>
<span><span class="co">#&gt; Database: DuckDB v0.9.2 [unknown@Linux 6.2.0-1019-azure:R 4.3.2/:memory:]</span></span>
<span><span class="co">#&gt; $ cohort_definition_id         <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…</span></span>
<span><span class="co">#&gt; $ subject_id                   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 25, 12, 36, 146, 186, 22, 92, 97, 103, 12…</span></span>
<span><span class="co">#&gt; $ cohort_start_date            <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 2013-04-08, 2003-06-26, 2018-05-24, 2008…</span></span>
<span><span class="co">#&gt; $ cohort_end_date              <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 2016-08-10, 2004-10-19, 2019-10-31, 2008…</span></span>
<span><span class="co">#&gt; $ duration                     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1221, 482, 526, 34, 1659, 138, 77, 638, 1…</span></span>
<span><span class="co">#&gt; $ number_exposures             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1, 1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 3, 1, 1,…</span></span>
<span><span class="co">#&gt; $ cumulative_quantity          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 30, 15, 90, 40, 15, 50, 80, 60, 50, 130, …</span></span>
<span><span class="co">#&gt; $ initial_quantity             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 30, 15, 10, 40, 15, 50, 80, 60, 50, 30, 6…</span></span>
<span><span class="co">#&gt; $ impute_duration_percentage   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…</span></span>
<span><span class="co">#&gt; $ number_eras                  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…</span></span>
<span><span class="co">#&gt; $ impute_daily_dose_percentage <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…</span></span>
<span><span class="co">#&gt; $ initial_daily_dose_milligram <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 235.872236, 12.448133, 182.509506, 11294.…</span></span>
<span><span class="co">#&gt; $ cumulative_dose_milligram    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 288000, 6000, 128000, 384000, 6000, 48000…</span></span></code></pre></div>
<p>As seen, the following columns have been added:</p>
<p><strong>1. number_exposures:</strong> Number of exposures during the
cohort observation.</p>
<p><strong>2. cumulative_quantity:</strong> Cumulative sum of the column
<em>quantity</em> of <em>drug_exposure</em> table during the drug
exposure period.</p>
<p><strong>3. initial_quantity:</strong> Quantity at
<em>drug_exposure_start_date</em>.</p>
<p><strong>4. impute_duration_percentage:</strong> If a drug exposure
record does not have the duration of the exposure, or falls outside a
specified range (see later), records will be imputed. This column shows
the number of records that have been imputed or that would be
imputed.</p>
<p><strong>5. number_eras:</strong> Number of eras within each drug
exposure period.</p>
<p><strong>6. impute_daily_dose_percentage:</strong> If a drug exposure
record does not have the daily dose of the exposure, or falls outside a
specified range (see later), records will be imputed. This column shows
the number of records that have been imputed or that would be
imputed.</p>
<p><strong>7. initial_daily_dose_milligram:</strong> dose at
<em>drug_exposure_start_date</em>.</p>
<p><strong>8. cumulative_dose_milligram:</strong> cumulative sum of the
column <em>dose</em> of <em>drug_exposure</em> table during the drug
exposure period,</p>
<p>You can choose which columns will be added by defining the
<code>duration</code>, <code>quantity</code>, and <code>dose</code>
inputs as either TRUE or FALSE.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/addDrugUse.html">addDrugUse</a></span><span class="op">(</span></span>
<span>  cohort <span class="op">=</span> <span class="va">cdm</span><span class="op">[[</span><span class="st">"acetaminophen_users"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>  cdm    <span class="op">=</span> <span class="va">cdm</span>,</span>
<span>  ingredientConceptId <span class="op">=</span> <span class="fl">1125315</span>,</span>
<span>  duration <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  quantity <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  dose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: ??</span></span>
<span><span class="co">#&gt; Columns: 8</span></span>
<span><span class="co">#&gt; Database: DuckDB v0.9.2 [unknown@Linux 6.2.0-1019-azure:R 4.3.2/:memory:]</span></span>
<span><span class="co">#&gt; $ cohort_definition_id       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…</span></span>
<span><span class="co">#&gt; $ subject_id                 <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 25, 12, 36, 146, 186, 22, 92, 97, 103, 129,…</span></span>
<span><span class="co">#&gt; $ cohort_start_date          <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 2013-04-08, 2003-06-26, 2018-05-24, 2008-0…</span></span>
<span><span class="co">#&gt; $ cohort_end_date            <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 2016-08-10, 2004-10-19, 2019-10-31, 2008-0…</span></span>
<span><span class="co">#&gt; $ duration                   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1221, 482, 526, 34, 1659, 138, 77, 638, 124…</span></span>
<span><span class="co">#&gt; $ number_exposures           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1, 1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 3, 1, 1, 1…</span></span>
<span><span class="co">#&gt; $ impute_duration_percentage <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…</span></span>
<span><span class="co">#&gt; $ number_eras                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…</span></span></code></pre></div>
<p>If <code>duration</code>, <code>quantity</code>, and
<code>dose</code> are FALSE, only <em>number_exposures</em> and
<em>number_eras</em> will be added.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/addDrugUse.html">addDrugUse</a></span><span class="op">(</span></span>
<span>  cohort <span class="op">=</span> <span class="va">cdm</span><span class="op">[[</span><span class="st">"acetaminophen_users"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>  cdm    <span class="op">=</span> <span class="va">cdm</span>,</span>
<span>  ingredientConceptId <span class="op">=</span> <span class="fl">1125315</span>,</span>
<span>  gapEra <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  eraJoinMode <span class="op">=</span> <span class="st">"zero"</span>,</span>
<span>  duration <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  quantity <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  dose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: ??</span></span>
<span><span class="co">#&gt; Columns: 6</span></span>
<span><span class="co">#&gt; Database: DuckDB v0.9.2 [unknown@Linux 6.2.0-1019-azure:R 4.3.2/:memory:]</span></span>
<span><span class="co">#&gt; $ cohort_definition_id <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…</span></span>
<span><span class="co">#&gt; $ subject_id           <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 25, 12, 36, 146, 186, 22, 92, 97, 103, 129, 7, 86…</span></span>
<span><span class="co">#&gt; $ cohort_start_date    <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 2013-04-08, 2003-06-26, 2018-05-24, 2008-04-22, …</span></span>
<span><span class="co">#&gt; $ cohort_end_date      <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 2016-08-10, 2004-10-19, 2019-10-31, 2008-05-25, …</span></span>
<span><span class="co">#&gt; $ number_exposures     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1, 1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 3, 1, 1, 2, 1, 2…</span></span>
<span><span class="co">#&gt; $ number_eras          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…</span></span></code></pre></div>
<div class="section level4">
<h4 id="gapera">gapEra<a class="anchor" aria-label="anchor" href="#gapera"></a>
</h4>
<p><code>gapEra</code> parameter defines the number of days between two
continuous drug exposures. Let’s see an example.</p>
<p>First, let’s create a cohort with <code>gapEra = 0</code>. For a
better understanding, let’s observe only subject_id number 56.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cdm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generateDrugUtilisationCohortSet.html">generateDrugUtilisationCohortSet</a></span><span class="op">(</span></span>
<span>  cdm <span class="op">=</span> <span class="va">cdm</span>,</span>
<span>  name <span class="op">=</span> <span class="st">"acetaminophen_example1"</span>,</span>
<span>  conceptSet <span class="op">=</span> <span class="va">conceptList</span>,</span>
<span>  gapEra <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span>
<span> </span>
<span><span class="va">cdm</span><span class="op">$</span><span class="va">drug_exposure</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">drug_concept_id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="op">!</span><span class="op">!</span><span class="va">conceptList</span><span class="op">$</span><span class="va">acetaminophen</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">person_id</span> <span class="op">==</span> <span class="fl">56</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: ??</span></span>
<span><span class="co">#&gt; Columns: 7</span></span>
<span><span class="co">#&gt; Database: DuckDB v0.9.2 [unknown@Linux 6.2.0-1019-azure:R 4.3.2/:memory:]</span></span>
<span><span class="co">#&gt; $ drug_exposure_id         <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 166, 164</span></span>
<span><span class="co">#&gt; $ person_id                <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 56, 56</span></span>
<span><span class="co">#&gt; $ drug_concept_id          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1125360, 43135274</span></span>
<span><span class="co">#&gt; $ drug_exposure_start_date <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 2022-01-27, 2021-08-08</span></span>
<span><span class="co">#&gt; $ drug_exposure_end_date   <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 2022-03-04, 2021-09-17</span></span>
<span><span class="co">#&gt; $ drug_type_concept_id     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 38000177, 38000177</span></span>
<span><span class="co">#&gt; $ quantity                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 100, 20</span></span></code></pre></div>
<p>This subject has two different drug exposure periods separated by
less than 6 months. Hence, it has two different cohort periods:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cdm</span><span class="op">$</span><span class="va">acetaminophen_example1</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/addDrugUse.html">addDrugUse</a></span><span class="op">(</span></span>
<span>    ingredientConceptId <span class="op">=</span> <span class="fl">1125315</span>,</span>
<span>    gapEra <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">subject_id</span> <span class="op">==</span> <span class="fl">56</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: ??</span></span>
<span><span class="co">#&gt; Columns: 13</span></span>
<span><span class="co">#&gt; Database: DuckDB v0.9.2 [unknown@Linux 6.2.0-1019-azure:R 4.3.2/:memory:]</span></span>
<span><span class="co">#&gt; $ cohort_definition_id         <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 1, 1</span></span>
<span><span class="co">#&gt; $ subject_id                   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 56, 56</span></span>
<span><span class="co">#&gt; $ cohort_start_date            <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 2022-01-27, 2021-08-08</span></span>
<span><span class="co">#&gt; $ cohort_end_date              <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 2022-03-04, 2021-09-17</span></span>
<span><span class="co">#&gt; $ duration                     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 37, 41</span></span>
<span><span class="co">#&gt; $ number_exposures             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1, 1</span></span>
<span><span class="co">#&gt; $ cumulative_quantity          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 100, 20</span></span>
<span><span class="co">#&gt; $ initial_quantity             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 100, 20</span></span>
<span><span class="co">#&gt; $ impute_duration_percentage   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0, 0</span></span>
<span><span class="co">#&gt; $ number_eras                  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1, 1</span></span>
<span><span class="co">#&gt; $ impute_daily_dose_percentage <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0, 0</span></span>
<span><span class="co">#&gt; $ initial_daily_dose_milligram <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1351.351, 195.122</span></span>
<span><span class="co">#&gt; $ cumulative_dose_milligram    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 50000, 8000</span></span></code></pre></div>
<p>Let’s merge this two periods by modifying the <code>gapEra</code>
input when creating the cohort. For a better understanding of
<code>gapEra</code> arguments and functionalities, please see <em>Use
DrugUtilisation to create a cohort</em> vignette.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cdm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generateDrugUtilisationCohortSet.html">generateDrugUtilisationCohortSet</a></span><span class="op">(</span></span>
<span>  cdm <span class="op">=</span> <span class="va">cdm</span>,</span>
<span>  name <span class="op">=</span> <span class="st">"acetaminophen_example2"</span>,</span>
<span>  conceptSet <span class="op">=</span> <span class="va">conceptList</span>,</span>
<span>  gapEra <span class="op">=</span> <span class="fl">180</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">cdm</span><span class="op">$</span><span class="va">acetaminophen_example2</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/addDrugUse.html">addDrugUse</a></span><span class="op">(</span></span>
<span>    ingredientConceptId <span class="op">=</span> <span class="fl">1125315</span>,</span>
<span>    gapEra <span class="op">=</span> <span class="fl">180</span>,</span>
<span>    duration <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    quantity <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    dose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">subject_id</span> <span class="op">==</span> <span class="fl">56</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: ??</span></span>
<span><span class="co">#&gt; Columns: 8</span></span>
<span><span class="co">#&gt; Database: DuckDB v0.9.2 [unknown@Linux 6.2.0-1019-azure:R 4.3.2/:memory:]</span></span>
<span><span class="co">#&gt; $ cohort_definition_id       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 1</span></span>
<span><span class="co">#&gt; $ subject_id                 <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 56</span></span>
<span><span class="co">#&gt; $ cohort_start_date          <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 2021-08-08</span></span>
<span><span class="co">#&gt; $ cohort_end_date            <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 2022-03-04</span></span>
<span><span class="co">#&gt; $ duration                   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 209</span></span>
<span><span class="co">#&gt; $ number_exposures           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2</span></span>
<span><span class="co">#&gt; $ impute_duration_percentage <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0</span></span>
<span><span class="co">#&gt; $ number_eras                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1</span></span></code></pre></div>
<p>Mow we have only one record with two exposures for subject number 56.
Note that the number of eras is still 1, as we have defined the same
<code>gapEra</code> as when the cohort was created. However, it is
possible to specify a different <code>gapEra</code> than the one defined
when the cohort was created.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cdm</span><span class="op">$</span><span class="va">acetaminophen_example2</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/addDrugUse.html">addDrugUse</a></span><span class="op">(</span></span>
<span>    ingredientConceptId <span class="op">=</span> <span class="fl">1125315</span>,</span>
<span>    gapEra <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">subject_id</span> <span class="op">==</span> <span class="fl">56</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: ??</span></span>
<span><span class="co">#&gt; Columns: 13</span></span>
<span><span class="co">#&gt; Database: DuckDB v0.9.2 [unknown@Linux 6.2.0-1019-azure:R 4.3.2/:memory:]</span></span>
<span><span class="co">#&gt; $ cohort_definition_id         <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 1</span></span>
<span><span class="co">#&gt; $ subject_id                   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 56</span></span>
<span><span class="co">#&gt; $ cohort_start_date            <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 2021-08-08</span></span>
<span><span class="co">#&gt; $ cohort_end_date              <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 2022-03-04</span></span>
<span><span class="co">#&gt; $ duration                     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 209</span></span>
<span><span class="co">#&gt; $ number_exposures             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2</span></span>
<span><span class="co">#&gt; $ cumulative_quantity          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 120</span></span>
<span><span class="co">#&gt; $ initial_quantity             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 20</span></span>
<span><span class="co">#&gt; $ impute_duration_percentage   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0</span></span>
<span><span class="co">#&gt; $ number_eras                  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2</span></span>
<span><span class="co">#&gt; $ impute_daily_dose_percentage <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0</span></span>
<span><span class="co">#&gt; $ initial_daily_dose_milligram <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 195.122</span></span>
<span><span class="co">#&gt; $ cumulative_dose_milligram    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 58000</span></span></code></pre></div>
<p>Note that <em>number_eras</em> now indicates that we have two eras
within the same record.</p>
</div>
<div class="section level4">
<h4 id="erajoinmode">eraJoinMode<a class="anchor" aria-label="anchor" href="#erajoinmode"></a>
</h4>
<p><em>subject_id</em> number 56 has two separate exposure periods. As
observed, by defining the <code>gapEra</code>, we can merge these two
periods into a single era. However, there are different ways to join
these two continuous exposures, and this can be specified with
<code>eraJoinMode</code>.</p>
<p>The are three different ways to join different continuous
exposures:</p>
<ol style="list-style-type: decimal">
<li>
<code>eraJoinMode = "zero" (default option)</code>: Subject’s daily
dose during the period between both continuous exposures is zero.
However, the time elapsed between these exposures contributes to the
total exposed time.</li>
</ol>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cdm</span><span class="op">$</span><span class="va">acetaminophen_example2</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/addDrugUse.html">addDrugUse</a></span><span class="op">(</span></span>
<span>    ingredientConceptId <span class="op">=</span> <span class="fl">1125315</span>,</span>
<span>    gapEra <span class="op">=</span> <span class="fl">180</span>,</span>
<span>    duration <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    quantity <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    dose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    eraJoinMode <span class="op">=</span> <span class="st">"zero"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">subject_id</span> <span class="op">==</span> <span class="fl">56</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: ??</span></span>
<span><span class="co">#&gt; Columns: 13</span></span>
<span><span class="co">#&gt; Database: DuckDB v0.9.2 [unknown@Linux 6.2.0-1019-azure:R 4.3.2/:memory:]</span></span>
<span><span class="co">#&gt; $ cohort_definition_id         <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 1</span></span>
<span><span class="co">#&gt; $ subject_id                   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 56</span></span>
<span><span class="co">#&gt; $ cohort_start_date            <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 2021-08-08</span></span>
<span><span class="co">#&gt; $ cohort_end_date              <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 2022-03-04</span></span>
<span><span class="co">#&gt; $ duration                     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 209</span></span>
<span><span class="co">#&gt; $ number_exposures             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2</span></span>
<span><span class="co">#&gt; $ cumulative_quantity          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 120</span></span>
<span><span class="co">#&gt; $ initial_quantity             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 20</span></span>
<span><span class="co">#&gt; $ impute_duration_percentage   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0</span></span>
<span><span class="co">#&gt; $ number_eras                  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1</span></span>
<span><span class="co">#&gt; $ impute_daily_dose_percentage <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0</span></span>
<span><span class="co">#&gt; $ initial_daily_dose_milligram <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 195.122</span></span>
<span><span class="co">#&gt; $ cumulative_dose_milligram    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 58000</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>
<code>eraJoinMode = "previous"</code>: The subject’s daily dose
during the period between both continuous exposures is equal to the
daily dose of the earliest subexposure. The time between both exposures
contributes to the total exposed time.</li>
</ol>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cdm</span><span class="op">$</span><span class="va">acetaminophen_example2</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/addDrugUse.html">addDrugUse</a></span><span class="op">(</span></span>
<span>    ingredientConceptId <span class="op">=</span> <span class="fl">1125315</span>,</span>
<span>    gapEra <span class="op">=</span> <span class="fl">180</span>,</span>
<span>    duration <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    quantity <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    dose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    eraJoinMode <span class="op">=</span> <span class="st">"previous"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">subject_id</span> <span class="op">==</span> <span class="fl">56</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: ??</span></span>
<span><span class="co">#&gt; Columns: 13</span></span>
<span><span class="co">#&gt; Database: DuckDB v0.9.2 [unknown@Linux 6.2.0-1019-azure:R 4.3.2/:memory:]</span></span>
<span><span class="co">#&gt; $ cohort_definition_id         <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 1</span></span>
<span><span class="co">#&gt; $ subject_id                   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 56</span></span>
<span><span class="co">#&gt; $ cohort_start_date            <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 2021-08-08</span></span>
<span><span class="co">#&gt; $ cohort_end_date              <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 2022-03-04</span></span>
<span><span class="co">#&gt; $ duration                     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 209</span></span>
<span><span class="co">#&gt; $ number_exposures             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2</span></span>
<span><span class="co">#&gt; $ cumulative_quantity          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 120</span></span>
<span><span class="co">#&gt; $ initial_quantity             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 20</span></span>
<span><span class="co">#&gt; $ impute_duration_percentage   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0</span></span>
<span><span class="co">#&gt; $ number_eras                  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1</span></span>
<span><span class="co">#&gt; $ impute_daily_dose_percentage <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0</span></span>
<span><span class="co">#&gt; $ initial_daily_dose_milligram <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 195.122</span></span>
<span><span class="co">#&gt; $ cumulative_dose_milligram    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 83560.98</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>
<code>eraJoinMode = "subsequent"</code>: The subject’s daily dose
during the period between both continuous exposures is the daily dose of
the latest subexposure. The time between both exposures contributes to
the total exposed time.</li>
</ol>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cdm</span><span class="op">$</span><span class="va">acetaminophen_example2</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/addDrugUse.html">addDrugUse</a></span><span class="op">(</span></span>
<span>    ingredientConceptId <span class="op">=</span> <span class="fl">1125315</span>,</span>
<span>    gapEra <span class="op">=</span> <span class="fl">180</span>,</span>
<span>    duration <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    quantity <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    dose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    eraJoinMode <span class="op">=</span> <span class="st">"subsequent"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">subject_id</span> <span class="op">==</span> <span class="fl">56</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: ??</span></span>
<span><span class="co">#&gt; Columns: 13</span></span>
<span><span class="co">#&gt; Database: DuckDB v0.9.2 [unknown@Linux 6.2.0-1019-azure:R 4.3.2/:memory:]</span></span>
<span><span class="co">#&gt; $ cohort_definition_id         <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 1</span></span>
<span><span class="co">#&gt; $ subject_id                   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 56</span></span>
<span><span class="co">#&gt; $ cohort_start_date            <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 2021-08-08</span></span>
<span><span class="co">#&gt; $ cohort_end_date              <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 2022-03-04</span></span>
<span><span class="co">#&gt; $ duration                     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 209</span></span>
<span><span class="co">#&gt; $ number_exposures             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2</span></span>
<span><span class="co">#&gt; $ cumulative_quantity          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 120</span></span>
<span><span class="co">#&gt; $ initial_quantity             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 20</span></span>
<span><span class="co">#&gt; $ impute_duration_percentage   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0</span></span>
<span><span class="co">#&gt; $ number_eras                  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1</span></span>
<span><span class="co">#&gt; $ impute_daily_dose_percentage <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0</span></span>
<span><span class="co">#&gt; $ initial_daily_dose_milligram <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 195.122</span></span>
<span><span class="co">#&gt; $ cumulative_dose_milligram    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 235027</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="overlapmode">overlapMode<a class="anchor" aria-label="anchor" href="#overlapmode"></a>
</h4>
<p>In the previous example, we observed the merging of two separated
drug exposure periods into one era. Now, let’s explore how two
overlapping drug exposure periods can be merged. It’s important to note
that this input only impacts overlapping periods that do not share the
same start date. Refer to the input <code>sameIndexMode</code> for
details on managing overlapping periods with the same start date.</p>
<p>Let’s observe subject number 8.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cdm</span><span class="op">$</span><span class="va">drug_exposure</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">drug_concept_id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="op">!</span><span class="op">!</span><span class="va">conceptList</span><span class="op">$</span><span class="va">acetaminophen</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">person_id</span> <span class="op">==</span> <span class="fl">8</span><span class="op">)</span>  <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: ??</span></span>
<span><span class="co">#&gt; Columns: 7</span></span>
<span><span class="co">#&gt; Database: DuckDB v0.9.2 [unknown@Linux 6.2.0-1019-azure:R 4.3.2/:memory:]</span></span>
<span><span class="co">#&gt; $ drug_exposure_id         <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 27, 28</span></span>
<span><span class="co">#&gt; $ person_id                <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 8, 8</span></span>
<span><span class="co">#&gt; $ drug_concept_id          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1125360, 1125360</span></span>
<span><span class="co">#&gt; $ drug_exposure_start_date <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 1984-12-28, 1982-11-07</span></span>
<span><span class="co">#&gt; $ drug_exposure_end_date   <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 1985-10-29, 1986-11-11</span></span>
<span><span class="co">#&gt; $ drug_type_concept_id     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 38000177, 38000177</span></span>
<span><span class="co">#&gt; $ quantity                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 35, 1</span></span></code></pre></div>
<p>We can customize how the overlapping is handled using the
<code>overlapMode</code> input. In this case, there are five
options:</p>
<ol style="list-style-type: decimal">
<li>
<code>overlapMode* = "sum" (default)</code>: The daily dose
considered is the sum of all exposures.</li>
</ol>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cdm</span><span class="op">$</span><span class="va">acetaminophen_example2</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/addDrugUse.html">addDrugUse</a></span><span class="op">(</span></span>
<span>    ingredientConceptId <span class="op">=</span> <span class="fl">1125315</span>,</span>
<span>    duration <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    quantity <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    dose     <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    overlapMode <span class="op">=</span> <span class="st">"sum"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">subject_id</span> <span class="op">==</span> <span class="fl">8</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: ??</span></span>
<span><span class="co">#&gt; Columns: 9</span></span>
<span><span class="co">#&gt; Database: DuckDB v0.9.2 [unknown@Linux 6.2.0-1019-azure:R 4.3.2/:memory:]</span></span>
<span><span class="co">#&gt; $ cohort_definition_id         <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 1</span></span>
<span><span class="co">#&gt; $ subject_id                   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 8</span></span>
<span><span class="co">#&gt; $ cohort_start_date            <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 1982-11-07</span></span>
<span><span class="co">#&gt; $ cohort_end_date              <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 1986-11-11</span></span>
<span><span class="co">#&gt; $ number_exposures             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2</span></span>
<span><span class="co">#&gt; $ number_eras                  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1</span></span>
<span><span class="co">#&gt; $ impute_daily_dose_percentage <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0</span></span>
<span><span class="co">#&gt; $ initial_daily_dose_milligram <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.3410641</span></span>
<span><span class="co">#&gt; $ cumulative_dose_milligram    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 18000</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>
<code>overlapMode* = "previous"</code>: The daily dose considered is
that of the earliest exposure.</li>
</ol>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cdm</span><span class="op">$</span><span class="va">acetaminophen_example2</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/addDrugUse.html">addDrugUse</a></span><span class="op">(</span></span>
<span>    ingredientConceptId <span class="op">=</span> <span class="fl">1125315</span>,</span>
<span>    duration <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    quantity <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    dose     <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    overlapMode <span class="op">=</span> <span class="st">"previous"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">subject_id</span> <span class="op">==</span> <span class="fl">8</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: ??</span></span>
<span><span class="co">#&gt; Columns: 9</span></span>
<span><span class="co">#&gt; Database: DuckDB v0.9.2 [unknown@Linux 6.2.0-1019-azure:R 4.3.2/:memory:]</span></span>
<span><span class="co">#&gt; $ cohort_definition_id         <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 1</span></span>
<span><span class="co">#&gt; $ subject_id                   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 8</span></span>
<span><span class="co">#&gt; $ cohort_start_date            <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 1982-11-07</span></span>
<span><span class="co">#&gt; $ cohort_end_date              <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 1986-11-11</span></span>
<span><span class="co">#&gt; $ number_exposures             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2</span></span>
<span><span class="co">#&gt; $ number_eras                  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1</span></span>
<span><span class="co">#&gt; $ impute_daily_dose_percentage <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0</span></span>
<span><span class="co">#&gt; $ initial_daily_dose_milligram <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.3410641</span></span>
<span><span class="co">#&gt; $ cumulative_dose_milligram    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 500</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>
<code>overlapMode = "subsequent"</code>: The daily dose considered
is that of the latest exposure.</li>
</ol>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cdm</span><span class="op">$</span><span class="va">acetaminophen_example2</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/addDrugUse.html">addDrugUse</a></span><span class="op">(</span></span>
<span>    ingredientConceptId <span class="op">=</span> <span class="fl">1125315</span>,</span>
<span>    duration <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    quantity <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    dose     <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    overlapMode <span class="op">=</span> <span class="st">"subsequent"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">subject_id</span> <span class="op">==</span> <span class="fl">8</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains</a></span><span class="op">(</span><span class="st">"dose"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: ??</span></span>
<span><span class="co">#&gt; Columns: 3</span></span>
<span><span class="co">#&gt; Database: DuckDB v0.9.2 [unknown@Linux 6.2.0-1019-azure:R 4.3.2/:memory:]</span></span>
<span><span class="co">#&gt; $ impute_daily_dose_percentage <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0</span></span>
<span><span class="co">#&gt; $ initial_daily_dose_milligram <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.3410641</span></span>
<span><span class="co">#&gt; $ cumulative_dose_milligram    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 17895.63</span></span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>
<code>overlapMode = "minimum"</code>: The daily dose considered is
the minimum value among all exposures.</li>
</ol>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cdm</span><span class="op">$</span><span class="va">acetaminophen_example2</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/addDrugUse.html">addDrugUse</a></span><span class="op">(</span></span>
<span>    ingredientConceptId <span class="op">=</span> <span class="fl">1125315</span>,</span>
<span>    duration <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    quantity <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    dose     <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    overlapMode <span class="op">=</span> <span class="st">"minimum"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">subject_id</span> <span class="op">==</span> <span class="fl">8</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: ??</span></span>
<span><span class="co">#&gt; Columns: 9</span></span>
<span><span class="co">#&gt; Database: DuckDB v0.9.2 [unknown@Linux 6.2.0-1019-azure:R 4.3.2/:memory:]</span></span>
<span><span class="co">#&gt; $ cohort_definition_id         <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 1</span></span>
<span><span class="co">#&gt; $ subject_id                   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 8</span></span>
<span><span class="co">#&gt; $ cohort_start_date            <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 1982-11-07</span></span>
<span><span class="co">#&gt; $ cohort_end_date              <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 1986-11-11</span></span>
<span><span class="co">#&gt; $ number_exposures             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2</span></span>
<span><span class="co">#&gt; $ number_eras                  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1</span></span>
<span><span class="co">#&gt; $ impute_daily_dose_percentage <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0</span></span>
<span><span class="co">#&gt; $ initial_daily_dose_milligram <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.3410641</span></span>
<span><span class="co">#&gt; $ cumulative_dose_milligram    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 500</span></span></code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li>
<code>overlapMode = "maximum"</code>: The daily dose considered is
the maximum value among all exposures</li>
</ol>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cdm</span><span class="op">$</span><span class="va">acetaminophen_example2</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/addDrugUse.html">addDrugUse</a></span><span class="op">(</span></span>
<span>    ingredientConceptId <span class="op">=</span> <span class="fl">1125315</span>,</span>
<span>    duration <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    quantity <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    dose     <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    overlapMode <span class="op">=</span> <span class="st">"maximum"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">subject_id</span> <span class="op">==</span> <span class="fl">8</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: ??</span></span>
<span><span class="co">#&gt; Columns: 9</span></span>
<span><span class="co">#&gt; Database: DuckDB v0.9.2 [unknown@Linux 6.2.0-1019-azure:R 4.3.2/:memory:]</span></span>
<span><span class="co">#&gt; $ cohort_definition_id         <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 1</span></span>
<span><span class="co">#&gt; $ subject_id                   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 8</span></span>
<span><span class="co">#&gt; $ cohort_start_date            <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 1982-11-07</span></span>
<span><span class="co">#&gt; $ cohort_end_date              <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 1986-11-11</span></span>
<span><span class="co">#&gt; $ number_exposures             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2</span></span>
<span><span class="co">#&gt; $ number_eras                  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1</span></span>
<span><span class="co">#&gt; $ impute_daily_dose_percentage <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0</span></span>
<span><span class="co">#&gt; $ initial_daily_dose_milligram <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.3410641</span></span>
<span><span class="co">#&gt; $ cumulative_dose_milligram    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 17895.63</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="sameindexmode">sameIndexMode<a class="anchor" aria-label="anchor" href="#sameindexmode"></a>
</h4>
<p>This input works similarly to <code>overlapMode</code>, but
specifically impacts overlapping drug exposure periods with the same
start date. It has the options “minimum”, “maximum”, and “sum” (default
one), described in <code>overlapMode</code>.</p>
</div>
<div class="section level4">
<h4 id="imputeduration-and-imputedailydose">imputeDuration and imputeDailyDose<a class="anchor" aria-label="anchor" href="#imputeduration-and-imputedailydose"></a>
</h4>
<p>These inputs determine the way the duration or the daily dose will be
imputed if their value is NA or fall outside the specified range
(defined in the <code>durationRange</code> and
<code>dailyDoseRange</code> inputs). There are five possible values for
these two inputs:</p>
<ol style="list-style-type: decimal">
<li>
<code>imputeDuration/imputeDailyDose* = "none" (default)</code>:
imputation is not applied.</li>
<li>
<code>imputeDuration*/*imputeDailyDose = "median", "mean", "mode"</code>:
imputation method that will be used.</li>
<li>
<code>imputeDuration*/*imputeDailyDose</code> can also be a
numerical value that will replace the previous one.</li>
</ol>
</div>
<div class="section level4">
<h4 id="durationrange-and-dailydoserange">durationRange and dailyDoseRange<a class="anchor" aria-label="anchor" href="#durationrange-and-dailydoserange"></a>
</h4>
<p>These inputs are used to define the range within which the
duration/daily dose must be comprised. It should be a numeric vector of
length two, and the second value must be greater than or equal to the
first one. If set to NULL, no restrictions are applied.</p>
<p>If <code>durationRange</code> and <code>dailyDoseRange</code> are not
set to “none”, <code>imputeDuration</code> and
<code>imputeDailyDose</code> must be specified, respectively.</p>
</div>
</div>
<div class="section level2">
<h2 id="summarisedruguse">summariseDrugUse<a class="anchor" aria-label="anchor" href="#summarisedruguse"></a>
</h2>
<p>This function is employed to sum up the dose table across multiple
cohorts. Let’s see how it operates.</p>
<p>First, let’s use <code><a href="../reference/addDrugUse.html">addDrugUse()</a></code> to add drug details to our
“acetaminophen_users” cohort. Then, we can apply
<code><a href="../reference/summariseDrugUse.html">summariseDrugUse()</a></code> to explore the characteristics of the
cohort.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cdm</span><span class="op">[[</span><span class="st">"acetaminophen_users"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">cdm</span><span class="op">[[</span><span class="st">"acetaminophen_users"</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/addDrugUse.html">addDrugUse</a></span><span class="op">(</span></span>
<span>    cdm    <span class="op">=</span> <span class="va">cdm</span>,</span>
<span>    ingredientConceptId <span class="op">=</span> <span class="fl">1125315</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/summariseDrugUse.html">summariseDrugUse</a></span><span class="op">(</span><span class="va">cdm</span><span class="op">[[</span><span class="st">"acetaminophen_users"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 101</span></span>
<span><span class="co">#&gt; Columns: 15</span></span>
<span><span class="co">#&gt; $ cdm_name         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "DUS MOCK", "DUS MOCK", "DUS MOCK", "DUS MOCK", "DUS …</span></span>
<span><span class="co">#&gt; $ result_type      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "summarised_drug_use", "summarised_drug_use", "summar…</span></span>
<span><span class="co">#&gt; $ package_name     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "DrugUtilisation", "DrugUtilisation", "DrugUtilisatio…</span></span>
<span><span class="co">#&gt; $ package_version  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "0.5.0", "0.5.0", "0.5.0", "0.5.0", "0.5.0", "0.5.0",…</span></span>
<span><span class="co">#&gt; $ group_name       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "cohort_name", "cohort_name", "cohort_name", "cohort_…</span></span>
<span><span class="co">#&gt; $ group_level      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "acetaminophen", "acetaminophen", "acetaminophen", "a…</span></span>
<span><span class="co">#&gt; $ strata_name      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "overall", "overall", "overall", "overall", "overall"…</span></span>
<span><span class="co">#&gt; $ strata_level     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "overall", "overall", "overall", "overall", "overall"…</span></span>
<span><span class="co">#&gt; $ variable_name    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "number subjects", "number records", "duration", "dur…</span></span>
<span><span class="co">#&gt; $ variable_level   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…</span></span>
<span><span class="co">#&gt; $ estimate_name    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "count", "count", "min", "q05", "q25", "median", "q75…</span></span>
<span><span class="co">#&gt; $ estimate_type    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "numeric", "numeric", "numeric", "numeric", "numeric"…</span></span>
<span><span class="co">#&gt; $ estimate_value   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "117", "141", "1", "6", "85", "386", "1242", "4037", …</span></span>
<span><span class="co">#&gt; $ additional_name  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "overall", "overall", "overall", "overall", "overall"…</span></span>
<span><span class="co">#&gt; $ additional_level <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "overall", "overall", "overall", "overall", "overall"…</span></span></code></pre></div>
<div class="section level4">
<h4 id="strata">strata<a class="anchor" aria-label="anchor" href="#strata"></a>
</h4>
<p>We can employ this parameter to stratify our cohort and calculate the
estimates within every strata group.</p>
<p>Let’s use <code><a href="https://darwin-eu-dev.github.io/PatientProfiles/reference/addSex.html" class="external-link">addSex()</a></code> function from PatientProfiles to
include a sex column in our cohort. Subsequently, we can use it as a
strata parameter.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cdm</span><span class="op">[[</span><span class="st">"acetaminophen_users"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">cdm</span><span class="op">[[</span><span class="st">"acetaminophen_users"</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://darwin-eu-dev.github.io/PatientProfiles/reference/addSex.html" class="external-link">addSex</a></span><span class="op">(</span><span class="va">cdm</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/summariseDrugUse.html">summariseDrugUse</a></span><span class="op">(</span><span class="va">cdm</span><span class="op">[[</span><span class="st">"acetaminophen_users"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                 strata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"sex"</span> <span class="op">=</span> <span class="st">"sex"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 303</span></span>
<span><span class="co">#&gt; Columns: 15</span></span>
<span><span class="co">#&gt; $ cdm_name         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "DUS MOCK", "DUS MOCK", "DUS MOCK", "DUS MOCK", "DUS …</span></span>
<span><span class="co">#&gt; $ result_type      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "summarised_drug_use", "summarised_drug_use", "summar…</span></span>
<span><span class="co">#&gt; $ package_name     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "DrugUtilisation", "DrugUtilisation", "DrugUtilisatio…</span></span>
<span><span class="co">#&gt; $ package_version  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "0.5.0", "0.5.0", "0.5.0", "0.5.0", "0.5.0", "0.5.0",…</span></span>
<span><span class="co">#&gt; $ group_name       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "cohort_name", "cohort_name", "cohort_name", "cohort_…</span></span>
<span><span class="co">#&gt; $ group_level      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "acetaminophen", "acetaminophen", "acetaminophen", "a…</span></span>
<span><span class="co">#&gt; $ strata_name      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "overall", "overall", "overall", "overall", "overall"…</span></span>
<span><span class="co">#&gt; $ strata_level     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "overall", "overall", "overall", "overall", "overall"…</span></span>
<span><span class="co">#&gt; $ variable_name    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "number subjects", "number records", "duration", "dur…</span></span>
<span><span class="co">#&gt; $ variable_level   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…</span></span>
<span><span class="co">#&gt; $ estimate_name    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "count", "count", "min", "q05", "q25", "median", "q75…</span></span>
<span><span class="co">#&gt; $ estimate_type    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "numeric", "numeric", "numeric", "numeric", "numeric"…</span></span>
<span><span class="co">#&gt; $ estimate_value   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "117", "141", "1", "6", "85", "386", "1242", "4037", …</span></span>
<span><span class="co">#&gt; $ additional_name  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "overall", "overall", "overall", "overall", "overall"…</span></span>
<span><span class="co">#&gt; $ additional_level <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "overall", "overall", "overall", "overall", "overall"…</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="druguseestimates">drugUseEstimates<a class="anchor" aria-label="anchor" href="#druguseestimates"></a>
</h4>
<p>Use this input to specify the estimates to be calculated. By default,
it will compute the minimum value, quartiles (5%, 25%, 50% - median, 75%
and 95%), the maximum value, the mean, the standard deviation, and the
number of missings values for each column added with
<code><a href="../reference/addDrugUse.html">addDrugUse()</a></code>.</p>
</div>
<div class="section level4">
<h4 id="mincellcount">minCellCount<a class="anchor" aria-label="anchor" href="#mincellcount"></a>
</h4>
<p>Specify the minimum number of individuals that a strata group must
appear in the table.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Marti Catala, Mike Du, Yuchen Guo, Kim Lopez-Guell.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
